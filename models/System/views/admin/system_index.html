{template nheader.html}
<script type="text/javascript">
function dr_to_key() {
	$.post("{dr_url('system/syskey')}", function(data){
        $("#sys_key").val(data);
    });
    $.post("{dr_url('system/referer')}", function(data){
        $("#sys_referer").val(data);
    });
}
</script>
<div class="page-bar">
    <ul class="page-breadcrumb mylink">
        {$menu.link}
    </ul>
    <ul class="page-breadcrumb myname">
        {$menu.name}
    </ul>
    <div class="page-toolbar">
        <div class="btn-group pull-right">
            <button type="button" class="btn green btn-sm btn-outline dropdown-toggle" data-toggle="dropdown" aria-expanded="false" data-hover="dropdown"> {L('操作菜单')}
                <i class="fa fa-angle-down"></i>
            </button>
            <ul class="dropdown-menu pull-right" role="menu">
                {loop $menu.quick $t}
                <li>
                    <a href="{$t.url}">{$t.icon} {$t.name}</a>
                </li>
                {/loop}
                <li class="divider"> </li>
                <li>
                    <a href="javascript:window.location.reload();">
                        <i class="icon-refresh"></i> {L('刷新页面')}</a>
                </li>
            </ul>
        </div>
    </div>
</div>
<h3 class="page-title">
    <small></small>
</h3>

<form class="form-horizontal" action="" method="post" id="myform" name="myform">
<input name="page" id="mypage" type="hidden" value="{$page}" />
    <div class="portlet light bordered myfbody">
        <div class="portlet-title tabbable-line">
            <ul class="nav nav-tabs" style="float:left;">
                <li class="{if $page==0}active{/if}">
                    <a href="#tab_0" data-toggle="tab" onclick="$('#mypage').val('0')"> <i class="fa fa-cog"></i> {L('基本设置')} </a>
                </li>
                <li class="{if $page==2}active{/if}">
                    <a href="#tab_2" data-toggle="tab" onclick="$('#mypage').val('2')"> <i class="fa fa-cubes"></i> {L('后台设置')} </a>
                </li>
                <li class="{if $page==3}active{/if}">
                    <a href="#tab_3" data-toggle="tab" onclick="$('#mypage').val('3')"> <i class="fa fa-cogs"></i> {L('后台域名')} </a>
                </li>
                <li class="{if $page==4}active{/if}">
                    <a href="#tab_4" data-toggle="tab" onclick="$('#mypage').val('4')"> <i class="fa fa-location-arrow"></i> {L('优化设置')} </a>
                </li>
                <li class="{if $page==5}active{/if}">
                    <a href="#tab_5" data-toggle="tab" onclick="$('#mypage').val('5')"> <i class="fa fa-clock-o"></i> {L('缓存时间')} </a>
                </li>
                <li class="{if $page==6}active{/if}">
                    <a href="#tab_6" data-toggle="tab" onclick="$('#mypage').val('6')"> <i class="fa fa-get-pocket"></i> {L('数据安全')} </a>
                </li>
                <li class="{if $page==7}active{/if}">
                    <a href="#tab_7" data-toggle="tab" onclick="$('#mypage').val('7')"> <i class="fa fa-rmb"></i> {L('交易配置')} </a>
                </li>
            </ul>
        </div>
        <div class="portlet-body">
            <div class="tab-content">

                <div class="tab-pane {if $page==0}active{/if}" id="tab_0">
                    <div class="form-body">
                        <div class="form-group">
                            <label class="col-md-2 control-label">{L('调试器')}：</label>
                            <div class="col-md-9">
                                <input type="checkbox" name="data[SYS_DEBUG]" value="TRUE" {if $data['SYS_DEBUG']}checked{/if} data-on-text="{L('开启')}" data-off-text="{L('关闭')}" data-on-color="success" data-off-color="danger" class="make-switch" data-size="small">
                                <span class="help-block">{L('用于后台查看程序和SQL执行详情')}</span>
                            </div>
                        </div>
                    </div>

                    <div class="form-body">
                        <div class="form-group">
                            <label class="col-md-2 control-label">{L('系统邮箱')}：</label>
                            <div class="col-md-9">
                                <label><input class="form-control" type="text" name="data[SYS_EMAIL]" value="{$data['SYS_EMAIL']}" ></label>
                                <span class="help-block">{L('用于接收系统发送的通知信息的可用邮箱')}</span>
                            </div>
                        </div>
                    </div>
                    <div class="form-body">
                        <div class="form-group">
                            <label class="col-md-2 control-label">{L('模板目录名称')}：</label>
                            <div class="col-md-9">
                                <label><input class="form-control" type="text" name="data[SYS_TEMPLATE]" value="{$data['SYS_TEMPLATE']}" readonly="" ></label>
                            </div>
                        </div>
                    </div>
                </div>

                <div class="tab-pane {if $page==2}active{/if}" id="tab_2">
                    <div class="form-body">
                        <div class="form-group">
                            <label class="col-md-2 control-label">{L('程序名称')}：</label>
                            <div class="col-md-9">
                                <label><input class="form-control" type="text" name="data[SYS_CMS]" value="{$data['SYS_CMS']}" ></label>

                            </div>
                        </div>
                        <div style="{if $admin.color=='v2'}display:block{else}display:none{/if}" class="form-group">
                            <label class="col-md-2 control-label">{L('Logo名称')}：</label>
                            <div class="col-md-9">
                                <label><input class="form-control" type="text" name="data[SYS_NAME]" value="{$data['SYS_NAME']}" ></label>
                            </div>
                        </div>
                        <div class="form-group">
                            <label class="col-md-2 control-label">{L('是否同步登录')}：</label>
                            <div class="col-md-9">
                                <input type="checkbox" name="data[SYS_SYNC_ADMIN]" value="TRUE" {if $data['SYS_SYNC_ADMIN']}checked{/if} data-on-text="{L('开启')}" data-off-text="{L('关闭')}" data-on-color="success" data-off-color="danger" class="make-switch" data-size="small">
                                <span class="help-block">{L('开启时当域名多的时候登录后台可能会卡几秒')}</span>
                            </div>
                        </div>
                        <div class="form-group">
                            <label class="col-md-2 control-label">{L('后台操作日志')}：</label>
                            <div class="col-md-9">
                                <input type="checkbox" name="data[SYS_LOG]" value="TRUE" {if $data['SYS_LOG']}checked{/if} data-on-text="{L('开启')}" data-off-text="{L('关闭')}" data-on-color="success" data-off-color="danger" class="make-switch" data-size="small">
                                <span class="help-block">{L('多用户操作后台建议打开日志功能')}</span>
                            </div>
                        </div>
                        <div class="form-group">
                            <label class="col-md-2 control-label">{L('后台登录验证码')}：</label>
                            <div class="col-md-9">
                                <input type="checkbox" name="data[SITE_ADMIN_CODE]" value="TRUE" {if $data['SITE_ADMIN_CODE']}checked{/if} data-on-text="{L('开启')}" data-off-text="{L('关闭')}" data-on-color="success" data-off-color="danger" class="make-switch" data-size="small">

                            </div>
                        </div>
                        <div class="form-group">
                            <label class="col-md-2 control-label">{L('后台数据分页条数')}：</label>
                            <div class="col-md-9">
                                <label><input class="form-control" type="text" name="data[SITE_ADMIN_PAGESIZE]" value="{$data['SITE_ADMIN_PAGESIZE']}" ></label>
                                <span class="help-block">{L('例如文章每页显示的数量控制')}</span>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="tab-pane {if $page==4}active{/if}" id="tab_4">
                    <div class="form-body">
                        <div class="form-group">
                            <label class="col-md-2 control-label">{L('最大在线人数')}：</label>
                            <div class="col-md-9">
                                <label><input class="form-control" type="text" name="data[SYS_ONLINE_NUM]" value="{$data['SYS_ONLINE_NUM']}" > </label>
                                <span class="help-block">{L('指服务器能承受的最大访问量，0为不限制，建议设置为平均在线人数的10倍左右')}</span>
                            </div>
                        </div>
                        <div class="form-group">
                            <label class="col-md-2 control-label">{L('在线保持时间')}：</label>
                            <div class="col-md-9">
                                <label><input class="form-control" type="text" name="data[SYS_ONLINE_TIME]" value="{$data['SYS_ONLINE_TIME']}" > </label>
                                <span class="help-block">{L('单位秒，访问量大的站点应当调小该数值，过大或者过小的设置都有可能会增大服务器资源开销')}</span>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="tab-pane {if $page==5}active{/if}" id="tab_5">
                    <div class="form-body row">

                        <div class="form-body">
                            <div class="form-group">
                                <label class="col-md-2 control-label">{L('缓存功能')}：</label>
                                <div class="col-md-9">
                                    <input type="checkbox" name="data[SYS_AUTO_CACHE]" value="TRUE" {if $data['SYS_AUTO_CACHE']}checked{/if} data-on-text="{L('开启')}" data-off-text="{L('关闭')}" data-on-color="success" data-off-color="danger" class="make-switch" data-size="small">
                                    <span class="help-block">{L('关闭缓存将会大大降低系统运行效率')}</span>
                                </div>
                            </div>
                        </div>
                        <div class="form-body">
                            <div class="form-group">
                                <label class="col-md-2 control-label">{L('Memcached 缓存')}：</label>
                                <div class="col-md-9">
                                    <input type="checkbox" name="data[SYS_MEMCACHE]" value="1" {if $data['SYS_MEMCACHE']}checked{/if} data-on-text="{L('开启')}" data-off-text="{L('关闭')}" data-on-color="success" data-off-color="danger" class="make-switch" data-size="small">
                                    <span class="help-block">{L('需要开启缓存功能此项才生效，可以在 config/memcached.php 配置文件中指定多个 Memcached 服务器')}</span>
                                </div>
                            </div>
                        </div>
                        {loop $config $i $t}
                        {if strpos($i, 'SYS_CACHE') === 0}
                        <div class="col-md-6">
                            <div class="form-group">
                                <label class="col-md-5 control-label">{L($t)}：</label>
                                <div class="col-md-5">
                                    <label><input class="form-control" type="text" name="data[{$i}]" value="{intval($data[$i])}" ></label>
                                    <label>{L("秒")}</label>
                                </div>
                            </div>
                        </div>
                        {/if}
                        {/loop}
                    </div>
                </div>
                <div class="tab-pane {if $page==6}active{/if}" id="tab_6">
                    <div class="form-body">
                        <div class="form-group">
                            <label class="col-md-2 control-label">{L('网站密钥')}：</label>
                            <div class="col-md-9">
                                <label><input class="form-control input-xlarge" type="text" name="data[SYS_KEY]" id="sys_key" value="{if $data['SYS_KEY']}************{/if}"  ></label>
                                <label><button class="btn btn-sm blue" type="button" name="button" onclick="dr_to_key()"> {L('重新生成')} </button></label>
                                <span class="help-block">{L('密钥建议定期更换')}</span>
                            </div>
                        </div>
                        <div class="form-group">
                            <label class="col-md-2 control-label">{L('移动端API密钥')}：</label>
                            <div class="col-md-9">
                                <input class="form-control" type="text" name="data[SYS_REFERER]" id="sys_referer" value="{if $data['SYS_REFERER']}************************{/if}"  >
                                <span class="help-block">{L('用于API数据调用的认证字符串')}</span>
                            </div>
                        </div>

                        <div class="form-body">
                            <div class="form-group">
                                <label class="col-md-2 control-label">{L('HTTPS模式')}：</label>
                                <div class="col-md-9">
                                    <input type="checkbox" name="data[SYS_HTTPS]" value="TRUE" {if $data['SYS_HTTPS']}checked{/if} data-on-text="{L('开启')}" data-off-text="{L('关闭')}" data-on-color="success" data-off-color="danger" class="make-switch" data-size="small">
                                    <span class="help-block">{L('开启之后全系统将采用https地址模式')}</span>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="tab-pane {if $page==7}active{/if}" id="tab_7">
                    <div class="form-body">
                        <div class="form-group">
                            <label class="col-md-2 control-label">{L('兑换比例')}：</label>
                            <div class="col-md-9">
                                {L('<label>1 '.SITE_MONEY.' = &nbsp;&nbsp;</label><label>%s</label><label>&nbsp;&nbsp;'.SITE_SCORE.'</label>', '<input class="form-control input-small" type="text" name="data[SITE_CONVERT]" value="'.$data['SITE_CONVERT'].'" />')}

                            </div>
                        </div>
                        <div class="form-group">
                            <label class="col-md-2 control-label">SITE_EXPERIENCE：</label>
                            <div class="col-md-9">
                                <label><input class="form-control" type="text" name="data[SITE_EXPERIENCE]" value="{$data['SITE_EXPERIENCE']}" ></label>
                                <span class="help-block">{L('例如“经验值”，“积分值”等等')}</span>
                            </div>
                        </div>
                        <div class="form-group">
                            <label class="col-md-2 control-label">SITE_SCORE：</label>
                            <div class="col-md-9">
                                <label><input class="form-control" type="text" name="data[SITE_SCORE]" value="{$data['SITE_SCORE']}" ></label>
                                <span class="help-block">{L('例如“虚拟值”，“F币”，“A币”，“B币”等等')}</span>
                            </div>
                        </div>
                        <div class="form-group">
                            <label class="col-md-2 control-label">SITE_MONEY：</label>
                            <div class="col-md-9">
                                <label><input class="form-control" type="text" name="data[SITE_MONEY]" value="{$data['SITE_MONEY']}" ></label>
                                <span class="help-block">{L('例如“RMB”，“人民币”，“资金”等等，实际交易为人民币')}</span>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="tab-pane {if $page==3}active{/if}" id="tab_3">
                    <div class="form-body">

                        {loop $ci->site_info $sid $t}
                        <div class="form-group">
                            <label class="col-md-2 control-label">{L(dr_strcut($t['SITE_NAME'], 20))}：</label>
                            <div class="col-md-9">
                                <label><input class="form-control input-large" type="text" name="domain[{$sid}]" value="{$domain[$sid]}" ></label>
                                <span class="help-block"><a href="{SYS_HELP_URL}2108.html" target="_blank">{L('绑定域名之后,只能通过此域名来访问该站点的后台')}</a></span>
                            </div>
                        </div>
                        {/loop}

                    </div>
                </div>
            </div>
        </div>
        <div class="myfooter">
            <div class="row">
                <div class="portlet-body form">
                    <div class="form-body">
                        <div class="form-actions">
                            <div class="row">
                                <div class="col-md-12 text-center">
                                    <button type="submit" class="btn green"> <i class="fa fa-save"></i> {L('保存')}</button>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</form>
<script type="text/javascript">
<!--
function memcache_test() {
	$("#memcache").val('Loading');
	$.get("{dr_url('system/memcache')}&"+Math.random(),function(data){
		alert(data);
		$("#memcache").val('{L('测试')}');
	})
}
//-->
</script>
{template nfooter.html}