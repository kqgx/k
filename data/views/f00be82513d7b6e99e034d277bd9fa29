<?php if ($fn_include = $this->_include("nheader.html")) include($fn_include); ?>

<div class="page-bar">
	<ul class="page-breadcrumb mylink">
		<?php echo $menu['link']; ?>
	</ul>
	<ul class="page-breadcrumb myname">
		<?php echo $menu['name']; ?>
	</ul>
	<div class="page-toolbar">
		<div class="btn-group pull-right">
			<button type="button" class="btn green btn-sm btn-outline dropdown-toggle" data-toggle="dropdown" aria-expanded="false" data-hover="dropdown"> <?php echo L('操作菜单'); ?>
				<i class="fa fa-angle-down"></i>
			</button>
			<ul class="dropdown-menu pull-right" role="menu">
				<?php if (is_array($menu['quick'])) { $count=count($menu['quick']);foreach ($menu['quick'] as $t) { ?>
				<li>
					<a href="<?php echo $t['url']; ?>"><?php echo $t['icon'];  echo $t['name']; ?></a>
				</li>
				<?php } } ?>
				<li class="divider"> </li>
				<li>
					<a href="javascript:window.location.reload();">
						<i class="icon-refresh"></i> <?php echo L('刷新页面'); ?></a>
				</li>
			</ul>
		</div>
	</div>
</div>

<h3 class="page-title">
	<small><?php echo L('应用安装方法: 将下载的应用文件放到./diy/app/目录之中,再到这里安装程序'); ?></small>
</h3>
<div class="portlet mylistbody">
	<div class="portlet-body">
		<div class="table-scrollable">

			<table class="mytable table table-striped table-bordered table-hover table-checkable dataTable">

		<thead>
		<tr>
			<th><?php echo L('名称'); ?></th>
			<th><?php echo L('目录'); ?></th>
			<th><?php echo L('版本'); ?></th>
			<th><?php echo L('开发者'); ?></th>
			<th><?php echo L('可用'); ?></th>
			<th class="dr_option"><?php echo L('操作'); ?></th>
		</tr>
		</thead>
		<tbody>
		<?php if (is_array($list[1])) { $count=count($list[1]);foreach ($list[1] as $dir=>$t) { ?>
		<tr>
			<td><?php echo $t['name']; ?></td>
			<td><?php echo $dir; ?></td>
            <td><?php echo $t['version']; ?></td>
			<td><?php echo $t['author']; ?></td>
			<td><?php if ($this->ci->is_auth('application/config')) { ?><a href="javascript:;" onClick="return dr_dialog_set('<?php echo $t['disabled'] ? L('<font color=blue><b>你确定要启用它？启用后将正常使用</b></font>') : L('<font color=red><b>你确定要禁用它？禁用后将无法使用</b></font>'); ?>','<?php echo dr_url('application/disabled',array('id'=>$t['id'])); ?>');"><img src="<?php echo THEME_PATH; ?>admin/images/<?php echo $t['disabled'] ? 0 : 1 ?>.gif"></a><?php } else { ?><img src="<?php echo THEME_PATH; ?>admin/images/<?php echo $t['disabled'] ? 0 : 1 ?>.gif"></a><?php } ?></td>

			<td class="dr_option">
			<?php if ($this->ci->is_auth('application/config')) { ?><a class="alist" href="<?php echo dr_url($dir.'/home/index'); ?>"> <i class="fa fa-cog"></i> <?php echo L('配置'); ?></a><?php }  if ($this->ci->is_auth('application/uninstall')) { ?><a class="adel" href="javascript:;" onClick="return dr_confirm_url('<?php echo L('您确定要这样操作吗？'); ?>','<?php echo dr_url($dir.'/home/uninstall'); ?>');"> <i class="fa fa-trash"></i> <?php echo L('卸载'); ?></a><?php } ?>

			</td>
		</tr>
		<?php } }  if (is_array($list[0])) { $count=count($list[0]);foreach ($list[0] as $dir=>$t) { ?>
		<tr class="dr_none">
			<td><?php echo $t['name']; ?></td>
			<td><?php echo $dir; ?></td>
            <td><?php echo $t['version']; ?></td>
			<td><?php echo $t['author']; ?></td>
		    <td>
				<?php if ($this->ci->is_auth('application/install')) { ?>
				<a href="javascript:void(0);" onclick="dr_install('', '<?php echo dr_url($dir.'/home/install'); ?>')" style="color:#00F">
				<?php } else { ?>
				<a href="javascript:;" style="color:#999">
				<?php }  echo L('安装'); ?></a>
			</td>
			<td class="dr_option">
            <?php if ($admin['adminid'] == 1) { ?><a href="javascript:;" class="adel" onClick="return dr_confirm_url('<font color=red><b><?php echo L('该操作将会从磁盘中彻底删除它且数据不可恢复，您确定吗？'); ?></b></font>','<?php echo dr_url('application/delete',array('dir'=>$dir)); ?>');"> <i class="fa fa-close"></i> <?php echo L('删除'); ?></a><?php } ?>
			</td>
		</tr>
		<?php } } ?>
		</tbody>
		</table>
		</div>
	</div>
</div>
<?php if ($fn_include = $this->_include("nfooter.html")) include($fn_include); ?>